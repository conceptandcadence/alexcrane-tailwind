let root=document.querySelector(":root"),campaign=!!document.querySelector("script[data-motivator-campaign]")&&document.querySelector("script[data-motivator-campaign]").innerHTML,cartMotivatorTemplate=!!document.querySelector(".motivator-templates .cart-motivator")&&document.querySelector(".motivator-templates .cart-motivator").innerHTML,bannerTemplate=!!document.querySelector(".motivator-templates .site-banner")&&document.querySelector(".motivator-templates .site-banner"),bannerText=!!document.querySelector(".motivator-templates .site-banner")&&document.querySelector(".motivator-templates .site-banner").innerHTML;function getNested(e,...t){return t.reduce(((e,t)=>e&&e[t]),e)}function waitFor(e,t){let r=setInterval((function(){void 0!==e?clearInterval(r):setTimeout((function(){clearInterval(r)}),1e4)}),10)}bannerTemplate?(document.querySelector("#shopify-section-header").prepend(bannerTemplate),console.log("Banner Active")):(root.style.setProperty("--site-banner-height","0px"),console.log("No Qualifying Banner Found")),window.motivator={campaign:JSON.parse(campaign),settings:{initialized:!1,validCampaign:!1},templates:{cart:cartMotivatorTemplate,banner:bannerText},initialize:()=>{if(motivator.settings.initialized)return;let e=document.querySelector(".rebuy-cart__motivator--widget");motivator.campaign&&document.querySelector("body").classList.add("motivator--active"),e&&motivator.templates.cart&&(e.innerHTML=motivator.templates.cart,document.querySelector(".motivator-templates .cart-motivator").remove()),e&&(motivator.campaign.settings?.color_background&&(e.style.backgroundColor=motivator.campaign.settings?.color_background),e.querySelector(".cart-motivator__progress-meter-fill")&&(e.querySelector(".cart-motivator__progress-meter-fill").style.backgroundColor=motivator.campaign.settings.color_progress),e.querySelector(".cart-motivator__goal-message")&&(e.querySelector(".cart-motivator__goal-message").style.color="#fff"),e.querySelector(".cart-motivator__goal-message")&&(e.querySelector(".cart-motivator__goal-message").style.backgroundColor=motivator.campaign.settings.color_progress),e.querySelector(".cart-motivator__progress-message")&&(e.querySelector(".cart-motivator__progress-message").style.color=motivator.campaign.settings.color_text),e.querySelector(".cart-motivator__progress-marker-text")&&(e.querySelector(".cart-motivator__progress-marker-text").style.color=motivator.campaign.settings.color_text),e.querySelector(".cart-motivator__progress-marker-completed")&&(e.querySelector(".cart-motivator__progress-marker-completed").style.color=motivator.campaign.settings.color_text)),motivator.settings.initialized=!0,motivator.settings.validCampaign=!0,console.log("Cart Motivator Initialized")},update:()=>{motivator.settings.initialized&&motivator.settings.validCampaign||motivator.initialize();let e,t,r,o,a,i,m,l,c=document.querySelector(".rebuy-cart__motivator--widget"),s=window.Rebuy.SmartCart.cart.total_price,n=motivator.campaign?.goal1?.value?motivator.campaign.goal1.value:-1,g=motivator.campaign?.goal2?.value?motivator.campaign.goal2.value:-1,v=motivator.campaign?.goal3?.value?motivator.campaign.goal3.value:-1,u=!1,p=!1,y=!1,d="",_=Math.max(n,g,v),S=s/_*100+"%",q=!0;motivator.campaign?.goal1&&(s<motivator.campaign.goal1.value&&(a=motivator.campaign.goal1),motivator.campaign.goal1.value<=s&&(u=!0,d=motivator.campaign.goal1.message),motivator.campaign.goal1.value===_&&(o=motivator.campaign.goal1),e=n/_*100+"%"),motivator.campaign?.goal2&&(s<motivator.campaign.goal2.value&&s>=motivator.campaign.goal1.value&&(a=motivator.campaign.goal2),motivator.campaign.goal2.value<=s&&(p=!0,d=motivator.campaign.goal2.message),motivator.campaign.goal2.value===_&&(o=motivator.campaign.goal2),t=(g-n)/_*100+"%"),motivator.campaign?.goal3&&(s<motivator.campaign.goal3.value&&s>=motivator.campaign.goal2.value&&(a=motivator.campaign.goal3),motivator.campaign.goal3.value<=s&&(y=!0,d=motivator.campaign.goal3.message),motivator.campaign.goal3.value===_&&(o=motivator.campaign.goal3),r=(v-g)/_*100+"%"),c.querySelector(".cart-motivator__progress-meter")&&(_<=s?(q=!1,c.querySelector(".cart-motivator__progress-meter").classList.remove("has-progress"),c.querySelector(".cart-motivator__progress-meter").classList.add("completed")):(c.querySelector(".cart-motivator__progress-meter").classList.add("has-progress"),c.querySelector(".cart-motivator__progress-meter").classList.remove("completed"))),window.motivator.campaign&&(m=window.motivator.campaign.settings.template,l=window.motivator.campaign.settings.complete),a&&(m=m.replace("[MONEY]",slate.Currency.formatMoney(a.value-s,theme.moneyFormat)),m=m.replace("[GOAL]",a.title)),c.querySelector(".cart-motivator__progress-meter-fill")&&(q?(i=d,c.querySelector(".cart-motivator__progress-meter-fill").style.width=S,c.querySelector(".cart-motivator__progress-meter-fill-text").innerHTML=S,c.querySelector(".cart-motivator__progress-message").innerHTML=m):(i=o.message,c.querySelector(".cart-motivator__progress-message").innerHTML=l,c.querySelector(".cart-motivator__progress-meter-fill").style.width="100%",c.querySelector(".cart-motivator__progress-meter-fill").style.backgroundColor="#006AFF")),motivator.campaign.settings?.use_banner&&(s>0&&document.querySelector("#shopify-section-header .site-banner")?document.querySelector("#shopify-section-header .site-banner").innerHTML=q?m:l:document.querySelector("#shopify-section-header .site-banner").innerHTML=motivator.templates.banner);try{e&&c.querySelectorAll(".marker--goal1").length>0&&(c.querySelector(".marker--goal1").style.width=e),t&&c.querySelectorAll(".marker--goal2").length>0&&(c.querySelector(".marker--goal2").style.width=t),r&&c.querySelectorAll(".marker--goal3").length>0&&(c.querySelector(".marker--goal3").style.width=r),u?(document.querySelector(".marker--goal1")&&c.querySelector(".marker--goal1").classList.add("complete"),c.querySelector(".cart-motivator__goal-message").innerHTML=i,c.querySelector(".cart-motivator__goal-message").classList.add("active")):document.querySelector(".marker--goal1")&&c.querySelector(".marker--goal1").classList.remove("complete"),p?(document.querySelector(".marker--goal2")&&c.querySelector(".marker--goal2").classList.add("complete"),c.querySelector(".cart-motivator__goal-message").innerHTML=i,c.querySelector(".cart-motivator__goal-message").classList.add("active")):document.querySelector(".marker--goal2")&&c.querySelector(".marker--goal2").classList.remove("complete"),y?(document.querySelector(".marker--goal3")&&c.querySelector(".marker--goal3").classList.add("complete"),c.querySelector(".cart-motivator__goal-message").innerHTML=i,c.querySelector(".cart-motivator__goal-message").classList.add("active")):document.querySelector(".marker--goal3")&&c.querySelector(".marker--goal3").classList.remove("complete"),document.querySelector(".rebuy-cart__motivator .primary-title")&&""!==document.querySelector(".rebuy-cart__motivator .primary-title").innerHTML||c.querySelector(".cart-motivator__goal-message")&&c.querySelector(".cart-motivator__goal-message").classList.remove("active"),setTimeout((()=>{document.querySelector(".rebuy-cart__motivator .primary-title")&&""!==document.querySelector(".rebuy-cart__motivator .primary-title").innerHTML||c.querySelector(".cart-motivator__goal-message")&&c.querySelector(".cart-motivator__goal-message").classList.remove("active")}),"250")}catch(e){console.error(e)}console.log("Cart Motivator Updated")}},document.addEventListener("rebuy.productsChange",(function(e){waitFor(getNested(window,"Rebuy","SmartCart","cart"),motivator.update()),window.dispatchEvent(new Event("resize")),setTimeout((()=>{window.dispatchEvent(new Event("resize"))}),"250")}));
//# sourceMappingURL=motivator.min.js.map